#!/bin/bash

# Create the /home/__user__/.asl/testing/week-two

echo "
    _    ____  _                ____ _     ___ 
   / \  / ___|| |              / ___| |   |_ _|
  / _ \ \___ \| |      _____  | |   | |    | | 
 / ___ \ ___) | |___  |_____| | |___| |___ | | 
/_/   \_\____/|_____|          \____|_____|___|

============================================================================

Thank you for downloading and installing the @jworkman-fs/asl 
Node.js module. This module will play a crucial role throughout your 
journey in the Advanced Server-side Languages course this month. 
It conveniently contains all the code provided by your instructor, 
necessary for completing Weeks Two through Four. To view the documentation 
for this module, please refer to the README.md file included in the module, 
or visit the module’s page on the NPM registry website: 

  👉 Module Documentation Link
     🔗 https://www.npmjs.com/package/@jworkman-fs/asl?activeTab=readme


"

cd ..

echo "📦📦📦 -> @jworkman-fs/asl"
echo "  ☕ - Waking up the module and ensuring it gets its morning cup of Joe."
echo "  👉 - Setting up & configuring storage engine"
DIRECTORY="$HOME/.asl"

if [ ! -d "$DIRECTORY" ]; then
  mkdir -p "$DIRECTORY"
  echo "  ✅ - Settings storage engine was created successfully."
  mkdir -p $HOME/.asl/testing/week-two
  mkdir -p $HOME/.asl/testing/week-three
  mkdir -p $HOME/.asl/testing/week-four
fi

if [ ! -d "$DIRECTORY" ]; then
  "
      ‼️ ‼️ ‼️  - Uh oh!! Something went wrong. It looks like I couldn't 
      create a new directory under $HOME/.asl/testing for some reason. 
      This directory is needed in order to write down the results from 
      running your tests. Without it I can't run tests against your API, 
      then recall them later. Make sure you have granted, or been granted 
      the correct read, and write file permissions for your home folder. 
      Maybe try running your last command as sudo!? ‼️ ‼️ ‼️  
  "
else
  echo "  ✅ - Settings storage engine has already been setup. Skipping initial setup."
fi

# Now clear/clean them all for our next run
rm -rf $HOME/.asl/testing/week-two/*
rm -rf $HOME/.asl/testing/week-three/*
rm -rf $HOME/.asl/testing/week-four/*

echo "  ✅ - Done taking the trash out. Time for our Next job!"
echo "  🛜 - Testing connection to http://localhost:8080"
echo "  📟 - Crunching the numbers for your grade based off test results"
npm run test-contacts-resource
echo "  🗑️ - Taking out the trash from previous test results."
curl --silent -X DELETE http://localhost:8080/v1/contacts/325 > /dev/null
curl --silent -X DELETE http://localhost:8080/v1/contacts/324 > /dev/null
echo "📦📦📦 -> @jworkman-fs/asl"
